<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage data-theme=light><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>git 合并原理 - ✌yesplease's blog</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,user-scalable=yes"><meta name=MobileOptimized content="width"><meta name=HandheldFriendly content="true"><meta name=applicable-device content="pc,mobile"><meta name=color-scheme content="light dark"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=mobile-web-app-capable content="yes"><meta name=generator content="Hugo 0.152.2"><link rel=canonical href=https://cugbtang.github.io/post/devops/series-git-4/><meta name=author content="yesplease"><meta name=description content="git 合并原理 一、场景描述 记录一些常用操作
git status: 显示工作区和暂存区的状态 git diff: 显示工作区和暂存区之间的差异 git diff &ndash;cached: 显示暂存区和最新提交之间的差异 git diff [分支1] [分支2]: 比较两个分支之间的差异 git grep [关键词]: 在整个代码库中搜索指定关键词 git stash: 将当前修改暂存起来，切换到其他分支 git reset &ndash;hard [提交号]: 将当前分支的 HEAD 指针指向指定的提交，并重置工作区和暂存区 git rm [文件]: 从版本控制中移除文件 git rebase [提交号]: 交互式地合并、重新排序或编辑提交历史的 git cherry-pick [提交号]: 选择某个提交，并将其应用到当前分支 git blame [文件]: 显示指定文件的每一行是谁在哪个提交中修改的 git blame -L [起始行号],[结束行号] [文件]: 仅显示指定行范围的文件是谁修改的 git revert [提交号]: 创建一个新的提交，用于撤销指定的提交 git bisect start: 启动二分查找来定位引入问题的提交 git stash apply: 恢复最近一次暂存的修改，并将其从暂存堆栈中删除 git reflog: 显示 HEAD 和分支的历史记录，包括已经被删除的提交 git log &ndash;author=[作者]: 显示特定作者的提交历史 git tag [标签名] [提交号]: 在指定提交上创建一个标签 git show-branch: 显示本地分支的历史和状态 二、问问 gpt1 解释下git show
"><meta name=keywords content="devops,git"><meta property="og:url" content="https://cugbtang.github.io/post/devops/series-git-4/"><meta property="og:site_name" content="✌yesplease's blog"><meta property="og:title" content="git 合并原理"><meta property="og:description" content="git 合并原理 一、场景描述 记录一些常用操作
git status: 显示工作区和暂存区的状态 git diff: 显示工作区和暂存区之间的差异 git diff –cached: 显示暂存区和最新提交之间的差异 git diff [分支1] [分支2]: 比较两个分支之间的差异 git grep [关键词]: 在整个代码库中搜索指定关键词 git stash: 将当前修改暂存起来，切换到其他分支 git reset –hard [提交号]: 将当前分支的 HEAD 指针指向指定的提交，并重置工作区和暂存区 git rm [文件]: 从版本控制中移除文件 git rebase [提交号]: 交互式地合并、重新排序或编辑提交历史的 git cherry-pick [提交号]: 选择某个提交，并将其应用到当前分支 git blame [文件]: 显示指定文件的每一行是谁在哪个提交中修改的 git blame -L [起始行号],[结束行号] [文件]: 仅显示指定行范围的文件是谁修改的 git revert [提交号]: 创建一个新的提交，用于撤销指定的提交 git bisect start: 启动二分查找来定位引入问题的提交 git stash apply: 恢复最近一次暂存的修改，并将其从暂存堆栈中删除 git reflog: 显示 HEAD 和分支的历史记录，包括已经被删除的提交 git log –author=[作者]: 显示特定作者的提交历史 git tag [标签名] [提交号]: 在指定提交上创建一个标签 git show-branch: 显示本地分支的历史和状态 二、问问 gpt1 解释下git show"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2023-07-30T16:01:23+08:00"><meta property="article:modified_time" content="2023-07-30T16:01:23+08:00"><meta property="article:tag" content="Devops"><meta property="article:tag" content="Git"><meta itemprop=name content="git 合并原理"><meta itemprop=description content="git 合并原理 一、场景描述 记录一些常用操作
git status: 显示工作区和暂存区的状态 git diff: 显示工作区和暂存区之间的差异 git diff –cached: 显示暂存区和最新提交之间的差异 git diff [分支1] [分支2]: 比较两个分支之间的差异 git grep [关键词]: 在整个代码库中搜索指定关键词 git stash: 将当前修改暂存起来，切换到其他分支 git reset –hard [提交号]: 将当前分支的 HEAD 指针指向指定的提交，并重置工作区和暂存区 git rm [文件]: 从版本控制中移除文件 git rebase [提交号]: 交互式地合并、重新排序或编辑提交历史的 git cherry-pick [提交号]: 选择某个提交，并将其应用到当前分支 git blame [文件]: 显示指定文件的每一行是谁在哪个提交中修改的 git blame -L [起始行号],[结束行号] [文件]: 仅显示指定行范围的文件是谁修改的 git revert [提交号]: 创建一个新的提交，用于撤销指定的提交 git bisect start: 启动二分查找来定位引入问题的提交 git stash apply: 恢复最近一次暂存的修改，并将其从暂存堆栈中删除 git reflog: 显示 HEAD 和分支的历史记录，包括已经被删除的提交 git log –author=[作者]: 显示特定作者的提交历史 git tag [标签名] [提交号]: 在指定提交上创建一个标签 git show-branch: 显示本地分支的历史和状态 二、问问 gpt1 解释下git show"><meta itemprop=datePublished content="2023-07-30T16:01:23+08:00"><meta itemprop=dateModified content="2023-07-30T16:01:23+08:00"><meta itemprop=wordCount content="3076"><meta itemprop=keywords content="Devops,Git"><meta name=twitter:card content="summary"><meta name=twitter:title content="git 合并原理"><meta name=twitter:description content="git 合并原理 一、场景描述 记录一些常用操作
git status: 显示工作区和暂存区的状态 git diff: 显示工作区和暂存区之间的差异 git diff –cached: 显示暂存区和最新提交之间的差异 git diff [分支1] [分支2]: 比较两个分支之间的差异 git grep [关键词]: 在整个代码库中搜索指定关键词 git stash: 将当前修改暂存起来，切换到其他分支 git reset –hard [提交号]: 将当前分支的 HEAD 指针指向指定的提交，并重置工作区和暂存区 git rm [文件]: 从版本控制中移除文件 git rebase [提交号]: 交互式地合并、重新排序或编辑提交历史的 git cherry-pick [提交号]: 选择某个提交，并将其应用到当前分支 git blame [文件]: 显示指定文件的每一行是谁在哪个提交中修改的 git blame -L [起始行号],[结束行号] [文件]: 仅显示指定行范围的文件是谁修改的 git revert [提交号]: 创建一个新的提交，用于撤销指定的提交 git bisect start: 启动二分查找来定位引入问题的提交 git stash apply: 恢复最近一次暂存的修改，并将其从暂存堆栈中删除 git reflog: 显示 HEAD 和分支的历史记录，包括已经被删除的提交 git log –author=[作者]: 显示特定作者的提交历史 git tag [标签名] [提交号]: 在指定提交上创建一个标签 git show-branch: 显示本地分支的历史和状态 二、问问 gpt1 解释下git show"><link rel=icon href=/favicon.ico><link rel=stylesheet href=/css/style.min.e7c52960f769ac11bea62d460dc48cd995591740192e6c6f8c0f5585fb135c9d.css integrity="sha256-58UpYPdprBG+pi1GDcSM2ZVZF0AZLmxvjA9VhfsTXJ0=" media=screen crossorigin=anonymous><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--><script>(function(){var e=localStorage.getItem("theme")||"light";document.documentElement.setAttribute("data-theme",e)})()</script></head><body><div id=back-to-top></div><header class=site-header><div class=desktop-header><div class=desktop-header-logo><a href=/ class=logo>✌yesplease</a></div><nav class=desktop-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=https://cugbtang.github.io/>This is Home</a></li><li class=menu-item><a class=menu-item-link href=https://cugbtang.github.io/post/>Archives</a></li><li class=menu-item><a class=menu-item-link href=https://cugbtang.github.io/tags/>Tags</a></li><li class=menu-item><a class=menu-item-link href=https://cugbtang.github.io/about/>About</a></li><li class=menu-item><a class="theme-toggle menu-item-link" href=javascript:void(0);><svg aria-hidden="true" class="lucide lucide-sun hi-svg-inline theme-icon-light" fill="none" height="1em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>
<svg aria-hidden="true" class="lucide lucide-moon hi-svg-inline theme-icon-dark" fill="none" height="1em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M12 3a6 6 0 009 9 9 9 0 11-9-9z"/></svg></a></li><li class=menu-item><a class=menu-item-link href=https://cugbtang.github.io/index.xml rel="noopener alternate" type=application/rss+xml title=rss target=_blank><svg aria-hidden="true" class="lucide lucide-rss hi-svg-inline icon--rss" fill="none" height="1em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></li></ul></nav></div><div class=mobile-header><div id=mobile-navbar class=mobile-navbar><div id=mobile-navbar-icon class=mobile-navbar-icon><svg aria-hidden="true" class="lucide lucide-menu hi-svg-inline icon--menu" fill="none" height="1em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg></div><div class=mobile-navbar-logo><a href=/ class=logo>✌yesplease</a></div></div><div id=mobile-menu-close-modal class=mobile-menu-close-modal></div><nav id=mobile-menu class=mobile-menu><ul class=mobile-menu-list><li class=mobile-menu-item><a class=menu-item-link href=https://cugbtang.github.io/>This is Home</a></li><li class=mobile-menu-item><a class=menu-item-link href=https://cugbtang.github.io/post/>Archives</a></li><li class=mobile-menu-item><a class=menu-item-link href=https://cugbtang.github.io/tags/>Tags</a></li><li class=mobile-menu-item><a class=menu-item-link href=https://cugbtang.github.io/about/>About</a></li><li class=mobile-menu-item><a class="theme-toggle menu-item-link" href=javascript:void(0);><svg aria-hidden="true" class="lucide lucide-sun hi-svg-inline theme-icon-light" fill="none" height="1em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>
<svg aria-hidden="true" class="lucide lucide-moon hi-svg-inline theme-icon-dark" fill="none" height="1em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M12 3a6 6 0 009 9 9 9 0 11-9-9z"/></svg></a></li><li class=mobile-menu-item><a class=menu-item-link href=https://cugbtang.github.io/index.xml rel="noopener alternate" type=application/rss+xml title=rss target=_blank><svg aria-hidden="true" class="lucide lucide-rss hi-svg-inline icon--rss" fill="none" height="1em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></li></ul></nav></div></header><main id=main class="main pico container"><div class=content-wrapper><aside class=left-sidebar><nav class=toc id=toc><div class=toc-title>Table of Contents</div><div class="toc-content custom-scrollbar"><nav id=TableOfContents><ul><li><a href=#git-合并原理>git 合并原理</a></li><li><a href=#一场景描述>一、场景描述</a></li><li><a href=#二问问-gpt>二、问问 gpt</a></li><li><a href=#三小结>三、小结：</a></li><li><a href=#四参考>四、参考</a></li></ul></nav></div></nav></aside><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>git 合并原理</h1><div class=post-meta-list><div class="post-meta-item post-meta-author"><svg aria-hidden="true" class="lucide lucide-user-round-pen hi-svg-inline" fill="none" height="1em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M2 21a8 8 0 0110.821-7.487"/><path d="M21.378 16.626a1 1 0 00-3.004-3.004l-4.01 4.012a2 2 0 00-.506.854l-.837 2.87a.5.5.0 00.62.62l2.87-.837a2 2 0 00.854-.506z"/><circle cx="10" cy="8" r="5"/></svg>
<a href=/about><span class=post-meta-author-name>yesplease</span></a></div><div class="post-meta-item post-meta-time"><svg aria-hidden="true" class="lucide lucide-calendar-days hi-svg-inline" fill="none" height="1em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M8 2v4"/><path d="M16 2v4"/><rect width="18" height="18" x="3" y="4" rx="2"/><path d="M3 10h18"/><path d="M8 14h.01"/><path d="M12 14h.01"/><path d="M16 14h.01"/><path d="M8 18h.01"/><path d="M12 18h.01"/><path d="M16 18h.01"/></svg>
<time datetime=2023-07-30>2023-07-30</time></div><div class=post-meta__right><div class="post-meta-item post-meta-category"><a href=https://cugbtang.github.io/categories/devops/>devops</a>
<a href=https://cugbtang.github.io/categories/cloudnative/>cloudnative</a></div></div></div></header><div class=post-content><h2 id=git-合并原理>git 合并原理</h2><h2 id=一场景描述>一、场景描述</h2><p>记录一些常用操作</p><ul><li>git status: 显示工作区和暂存区的状态</li><li>git diff: 显示工作区和暂存区之间的差异</li><li>git diff &ndash;cached: 显示暂存区和最新提交之间的差异</li><li>git diff [分支1] [分支2]: 比较两个分支之间的差异</li><li>git grep [关键词]: 在整个代码库中搜索指定关键词</li><li>git stash: 将当前修改暂存起来，切换到其他分支</li><li>git reset &ndash;hard [提交号]: 将当前分支的 HEAD 指针指向指定的提交，并重置工作区和暂存区</li><li>git rm [文件]: 从版本控制中移除文件</li><li>git rebase [提交号]: 交互式地合并、重新排序或编辑提交历史的</li><li>git cherry-pick [提交号]: 选择某个提交，并将其应用到当前分支</li><li>git blame [文件]: 显示指定文件的每一行是谁在哪个提交中修改的</li><li>git blame -L [起始行号],[结束行号] [文件]: 仅显示指定行范围的文件是谁修改的</li><li>git revert [提交号]: 创建一个新的提交，用于撤销指定的提交</li><li>git bisect start: 启动二分查找来定位引入问题的提交</li><li>git stash apply: 恢复最近一次暂存的修改，并将其从暂存堆栈中删除</li><li>git reflog: 显示 HEAD 和分支的历史记录，包括已经被删除的提交</li><li>git log &ndash;author=[作者]: 显示特定作者的提交历史</li><li>git tag [标签名] [提交号]: 在指定提交上创建一个标签</li><li>git show-branch: 显示本地分支的历史和状态</li></ul><h2 id=二问问-gpt>二、问问 gpt<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></h2><hr><blockquote><p>解释下git show</p></blockquote><p><code>git show</code> 是一个非常有用的 Git 命令，它用于显示提交的详细信息和更改的内容。下面是 <code>git show</code> 的详细讲解：</p><p>基本语法：</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>git show [提交]</span></span></code></pre></div></div><p>参数：</p><ul><li><code>[提交]</code>: 可选参数，表示要查看的提交，默认为最新的提交。</li></ul><p>使用 <code>git show</code> 命令可以获取以下信息：</p><ol><li><p>提交信息：包括提交哈希值、作者、提交日期和提交消息。</p></li><li><p>修改的文件：列出了与该提交相关的所有修改过的文件。</p></li><li><p>文件更改的具体内容：展示了每个文件的具体更改内容，即新增、修改或删除的行。</p></li><li><p>代码差异：以 diff 的形式显示当前提交与其父提交之间的代码差异。</p></li><li><p>其他元数据：显示提交中的其他元数据，例如签名和标签。</p></li></ol><p>示例用法：</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>$ git show</span></span></code></pre></div></div><p>这将显示最新提交的详细信息和更改的内容。</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>$ git show abcdef123456</span></span></code></pre></div></div><p>这将显示提交哈希值为 <code>abcdef123456</code> 的提交的详细信息和更改的内容。</p><p><code>git show</code> 命令在查看历史提交、检查代码更改、审查提交信息等方面非常有用。通过查看提交的详细信息，开发者可以更好地理解代码库的演变历史并进行必要的代码审查和调试。记住，你可以使用其他参数和选项来进一步定制 <code>git show</code> 命令的输出。可以通过 <code>git show --help</code> 查看详细的帮助文档。</p><hr><blockquote><p>解释下 git rebase -i commit</p></blockquote><p>当你运行 <code>git rebase -i commit</code> 命令时，你可以使用交互式界面对提交历史进行编辑。下面是一个示例：</p><p>假设你有如下的提交历史：</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><pre tabindex=0><code>commit C: Add feature C
commit B: Add feature B
commit A: Add feature A</code></pre></div><p>现在你想要将提交 B 和提交 C 合并为一个提交，并编辑提交 A 的消息。你可以运行以下命令：</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><pre tabindex=0><code>git rebase -i commit</code></pre></div><p>Git 将会打开交互式界面，其中列出了提交历史的相关信息：</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><pre tabindex=0><code>pick abcdef1 commit A: Add feature A
pick bcdef23 commit B: Add feature B
pick def4567 commit C: Add feature C</code></pre></div><p>你可以对这些操作进行修改，以实现你的目标。在本例中，你可以将提交 B 和提交 C 合并为一个提交，然后编辑提交 A 的消息。你可以修改交互式界面如下：</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><pre tabindex=0><code>pick abcdef1 commit A: Add feature A
squash bcdef23 commit B: Add feature B
s/commit A: Add feature A/Edit feature A/</code></pre></div><p>保存并退出编辑器。Git 将会根据你的指示执行相应的操作。此时，Git 会自动合并提交 B 到提交 A，并修改提交 A 的消息。最终的提交历史将如下所示：</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><pre tabindex=0><code>commit A: Edit feature A
commit BC: Add feature B and C</code></pre></div><p>注意，在上述示例中，使用了 <code>squash</code> 命令来将提交 B 合并到提交 A，并使用 <code>s/commit A: Add feature A/Edit feature A/</code> 来编辑提交 A 的消息。</p><p>请注意，在执行类似于 <code>git rebase -i</code> 这样的操作时，一定要小心审查并确认你的更改，以免不小心破坏提交历史。</p><hr><blockquote><p>git bisect 详细介绍下</p></blockquote><p>git bisect 是 Git 提供的一个命令，用于帮助我们通过二分查找定位引入问题的提交。当我们在一个大型项目中发现了一个 bug，并且我们知道在之前的某个提交中出现了这个 bug，但是不知道具体是在哪个提交引入的时候，可以使用 git bisect 命令来快速定位。</p><p>下面是 git bisect 的详细使用步骤：</p><p>1、首先，进入到你的项目目录中，并确保你在一个干净的状态下（没有未提交的修改）。</p><p>2、执行 git bisect start 命令，表示开始二分查找。</p><p>3、通过 git bisect bad 命令告诉 Git 当前的代码状态是有问题的（即包含了 bug）。</p><p>4、使用 git bisect good [好的提交号] 或者 git bisect good [好的标签名] 命令指定一个已知的“好”（即没有问题的）的提交。</p><p>5、Git 会自动切换到一个中间的提交，并要求你测试这个提交是否存在 bug。根据测试结果使用 git bisect bad 或者 git bisect good 命令告诉 Git 这个中间提交是否含有 bug。</p><p>6、重复步骤 5，Git 会根据你的测试结果不断地切换到新的中间提交，直到找到引入问题的提交。</p><p>7、当 git bisect 定位到引入问题的提交时，Git 会给出相应的提示，并自动返回到该提交。</p><p>8、最后，执行 git bisect reset 命令结束二分查找过程，Git 会将你的 HEAD 恢复到初始状态。</p><p>通过以上步骤，你可以使用 git bisect 在复杂的代码历史中快速定位 bug 的引入提交。这个命令在大型项目中特别有用，可以节省定位问题的时间和精力。需要注意的是，你需要根据实际情况进行好坏提交的选择，并且在测试过程中保持良好的记录和反馈。</p><p>要将之前所有提交中的密码更改为 <code>***</code>，可以使用 <code>git filter-branch</code> 命令结合自定义脚本来实现。请按照以下步骤进行操作：</p><ol><li><p>首先，在你的项目目录下打开终端，并确保你当前在所需的分支上（例如，<code>master</code> 分支）。</p></li><li><p>运行以下命令来备份你的代码：</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>git branch backup</span></span></code></pre></div></div></li><li><p>创建一个名为 <code>replace_password.sh</code> 的脚本文件，并使用文本编辑器打开它。</p></li><li><p>在 <code>replace_password.sh</code> 文件中，输入以下内容：</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>#!/bin/bash
</span></span><span style=display:flex><span>git ls-files -z | while read -d &#39;&#39; -r file; do
</span></span><span style=display:flex><span>  if [[ $file == *&#34;&lt;文件路径&gt;&#34;* ]]; then
</span></span><span style=display:flex><span>    sed -i &#39;s/密码模式/*** /g&#39; &#34;$file&#34;
</span></span><span style=display:flex><span>  fi
</span></span><span style=display:flex><span>done</span></span></code></pre></div></div><p>将 <code>&lt;文件路径></code> 替换为包含密码的文件的路径或文件夹的路径。这将会在指定文件中查找并替换密码。</p></li><li><p>保存并关闭 <code>replace_password.sh</code> 文件。</p></li><li><p>运行以下命令来添加执行权限给脚本文件：</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>chmod +x replace_password.sh</span></span></code></pre></div></div></li><li><p>现在，运行以下命令来执行 <code>git filter-branch</code> 操作，并使用脚本文件作为过滤器：</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>git filter-branch --tree-filter &#39;/path/to/replace_password.sh&#39; --prune-empty HEAD</span></span></code></pre></div></div><p>将 <code>/path/to/replace_password.sh</code> 替换为 <code>replace_password.sh</code> 文件的实际路径。</p></li><li><p>Git 将会遍历所有的提交，并在每个提交上运行脚本文件，查找并替换指定文件中的密码。完成后，你的历史提交将被重写。</p></li><li><p>如果你已经将这些提交推送到远程仓库，你需要使用 <code>git push --force</code> 强制推送修改后的提交历史：</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>git push --force</span></span></code></pre></div></div></li></ol><p>这样，你就可以使用自定义脚本来批量替换之前所有提交中的密码。但请注意，执行 <code>git filter-branch</code> 操作时，也要小心谨慎，因为它会修改提交历史。确保在操作之前备份代码，并在必要时咨询有经验的 Git 使用者或开发者。</p><hr><blockquote><p>sparse-checkout 详细讲解下</p></blockquote><p><code>sparse-checkout</code> 是 Git 的一个功能，用于部分克隆（partial clone）仓库。它允许你只检出仓库中指定目录或文件的内容，而不是完整地克隆整个仓库。这对于大型仓库或仅需要特定部分代码的情况非常有用，可以显著节省下载和存储空间。</p><p>下面是 <code>sparse-checkout</code> 的详细讲解：</p><ol><li><p>配置 <code>sparse-checkout</code>：在进行部分克隆之前，需先配置 <code>sparse-checkout</code>。</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ git sparse-checkout init</span></span></code></pre></div></div></li><li><p>添加感兴趣的目录或文件：通过指定要检出的目录或文件，告诉 Git 哪些部分是你感兴趣的。</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ git sparse-checkout set &lt;目录/文件&gt;</span></span></code></pre></div></div><p>你可以多次运行该命令来添加多个目录或文件。</p></li><li><p>完成部分克隆：现在你可以执行部分克隆命令，只拉取感兴趣的部分。</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ git clone --filter<span style=color:#f92672>=</span>blob:none &lt;远程仓库URL&gt;</span></span></code></pre></div></div><p>注意，在使用 <code>--filter=blob:none</code> 标志进行部分克隆时，仓库中的大文件将不会被下载，只有文件元数据（例如文件名和文件大小）会被获取。</p></li><li><p>更新和同步：一旦你进行了部分克隆，你可以像常规 Git 仓库一样更新和同步。</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ git pull origin &lt;分支&gt;</span></span></code></pre></div></div><p>Git 会根据你配置的 <code>sparse-checkout</code> 来更新和同步你感兴趣的部分。</p></li></ol><p>总结来说，<code>sparse-checkout</code> 提供了一种灵活的方式来只检出仓库中特定目录或文件的内容。它可以实现部分克隆，节省带宽和存储空间，并提高代码仓库的下载速度。记住，部分克隆功能在 Git 2.25 及更高版本中才可用。</p><h2 id=三小结>三、小结：</h2><p>附上一些常用缩写：</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>alias gc<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git config&#39;</span>
</span></span><span style=display:flex><span>alias gs<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git status&#39;</span>
</span></span><span style=display:flex><span>alias g<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git&#39;</span>
</span></span><span style=display:flex><span>alias ga<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git add&#39;</span>
</span></span><span style=display:flex><span>alias gaa<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git add -all&#39;</span>
</span></span><span style=display:flex><span>alias gp<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git push&#39;</span>
</span></span><span style=display:flex><span>alias gl<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git pull&#39;</span>
</span></span><span style=display:flex><span>alias gc<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git commit&#39;</span>
</span></span><span style=display:flex><span>alias gcm<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git commit -m&#39;</span>
</span></span><span style=display:flex><span>alias gcam<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git commit -am&#39;</span>
</span></span><span style=display:flex><span>alias gb<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git branch&#39;</span>
</span></span><span style=display:flex><span>alias gbr<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git branch -r&#39;</span>
</span></span><span style=display:flex><span>alias gba<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git branch -a&#39;</span>
</span></span><span style=display:flex><span>alias gco<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git checkout&#39;</span>
</span></span><span style=display:flex><span>alias gcb<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git checkout -b&#39;</span>
</span></span><span style=display:flex><span>alias gm<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git merge&#39;</span>
</span></span><span style=display:flex><span>alias gd<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git diff&#39;</span>
</span></span><span style=display:flex><span>alias gdw<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git diff --word-diff&#39;</span>
</span></span><span style=display:flex><span>alias glg<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;git lg&#39;</span></span></span></code></pre></div></div><h2 id=四参考>四、参考</h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href>gpt</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=post-copyright><p class=copyright-item><span class=item-title>Author</span>
<span class=item-content>yesplease</span></p><p class=copyright-item><span class=item-title>LastMod</span>
<span class=item-content>2023-07-30</span></p><p class=copyright-item><span class=item-title>License</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span></p></div><footer class=post-footer><div class=post-tags><a href=https://cugbtang.github.io/tags/devops/>devops</a>
<a href=https://cugbtang.github.io/tags/git/>git</a></div><nav class=post-nav><a class=prev href=/post/devops/series-git-2/><i class=iconfont><svg aria-hidden="true" class="lucide lucide-chevron-left hi-svg-inline" fill="none" height="1em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="m15 18-6-6 6-6"/></svg>
</i><span class="prev-text nav-default">git 以前的许多commit中某个文件含有密钥，怎么办？</span>
<span class="prev-text nav-mobile">Prev</span>
</a><a class=next href=/post/devops/series-git-3/><span class="next-text nav-default">git 常用操作</span>
<span class="prev-text nav-mobile">Next</span>
<i class=iconfont><svg aria-hidden="true" class="lucide lucide-chevron-right hi-svg-inline" fill="none" height="1em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="m9 18 6-6-6-6"/></svg></i></a></nav></footer></article></div><aside class=right-sidebar></aside></div></main><footer id=footer class=site-footer><div class=social-icon-links><a href=mailto:cugbtang@sina.com rel="me noopener" class=social-icon-link title=email><svg aria-hidden="true" class="icon hi-svg-inline" fill="currentColor" height="1em" viewBox="0 0 1451 1024" width="1em" xlink="http://www.w3.org/1999/xlink"><path d="M664.781909 681.472759.0 97.881301C0 3.997201 71.046997.0 71.046997.0H474.477909 961.649408h399.992405s71.046998 3.997201 71.046998 97.881301L771.345323 681.472759S764.482731 685.154773 753.594283 688.65053V688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858V688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759zm53.281707 130.131124C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633.0 212.052267.0 212.052267V942.809523S0 1024 83.726336 1024H682.532949 753.579947h595.368192C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523V212.052267S893.138176 701.759633 817.019477 767.734955c-39.771477 34.470494-74.671786 43.295855-98.955861 43.868928z"/></svg>
</a><a href=https://github.com/cugbtang rel="me noopener" class=social-icon-link title=github target=_blank><svg aria-hidden="true" class="icon hi-svg-inline" fill="currentColor" height="1em" viewBox="0 0 1024 1024" width="1em" xlink="http://www.w3.org/1999/xlink"><path d="M512 12.672c-282.88.0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667.0-12.16-.426667-44.373333-.64-87.04C242.005334 929.664 211.968 830.08 211.968 830.08 188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333.0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333.0.0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667.0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72.0 68.522667-.64 123.562667-.64 140.202666.0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"/></svg>
</a><a href=https://cugbtang.github.io/index.xml rel="noopener alternate" type=application/rss+xml class=social-icon-link title=rss target=_blank><svg aria-hidden="true" class="lucide lucide-rss hi-svg-inline" fill="none" height="1em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a>
</span><span class=division>|</span>
<span class=theme-info>Theme - <a class=theme-link href=https://github.com/xianmin/hugo-theme-jane>Jane</a>
</span><span class=copyright-year>&copy;
2017 -
2026
<span class=heart><i class=iconfont><svg aria-hidden="true" class="lucide lucide-heart hi-svg-inline" fill="none" height="1em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5.0 0016.5 3c-1.76.0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5.0 002 8.5c0 2.3 1.5 4.05 3 5.5l7 7z"/></svg>
</i></span><span class=author>yesplease</span></span></div></footer><script type=text/javascript src=/js/main.002d1a80e7bd914cb4592a8c6486c23920f3d9827531bd1c79b3b5716dcf0bd5.js integrity="sha256-AC0agOe9kUy0WSqMZIbCOSDz2YJ1Mb0cebO1cW3PC9U=" crossorigin=anonymous></script><script type=text/javascript src=/lib/photoswipe/photoswipe.min.js></script><script type=text/javascript src=/lib/photoswipe/photoswipe-ui-default.min.js></script></body></html>